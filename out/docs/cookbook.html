<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
    <script type="application/javascript" src="./playground.js"></script>
    <script type="application/javascript" src="./mermaid.js"></script>
    <script type="application/javascript" src="./prism.js"></script>
    <link rel="stylesheet" type="text/css" href="./prism.css">
    <script>mermaid.initialize({startOnLoad:true,flowchart:{useMaxWidth:false}});</script>
    <script>
      Temporal = { ...temporal.Temporal };
      Object.assign(Intl, temporal.Intl);
    </script>
    <style>
      /* https://github.com/kognise/water.css/blob/master/src/variables-light.css */
      :root {
        --background: #efefef;
        --text-muted: #999999;
        --text-bright: #000000;
        --text-width: 900px;
        --variable: #39a33c;
      }
      .mermaid svg { height: 13em; }
      body {
        font-size: 18px;
        max-width: var(--text-width);
        padding-top: 40px;  /* extra padding for banner */
      }
      pre { border-left: 4px solid var(--variable); }
      pre code[class*="language-"] { font-size: 0.85em; }
      pre[class*="language-"] { padding: 0.5em; }
      h2 { border-bottom: 2px solid var(--text-muted); margin-top: 2em; }
      h3 {
        border-bottom: 1px solid var(--text-muted);
        color: var(--text-muted);
        font-weight: normal;
      }
      h3 em { font-weight: bold; }
      h3 strong { color: var(--text-bright); }
      :not(h2) + h3 { margin-top: 2em; }
      footer {
        border-top: 1px solid var(--background);
        color: var(--text-muted);
        font-size: 0.8em;
        margin-top: 2em;
        padding-top: 10px;
      }
      .heading-link {
        left: calc((100vw - var(--text-width)) / 2 - 1.5em);
        opacity: 0;
        position: absolute;
        transition: opacity 150ms;
      }
      .heading-link:hover { text-decoration: none; }
      .heading-link::before { content: 'Â¶'; }
      h3:hover .heading-link { opacity: 1; }
      .banner {
        /* Gradient from https://joshnh.com/weblog/how-to-make-an-alert-bar/ */
        background-color: #fce94f;
        background-image: linear-gradient(135deg,
                                          transparent,
                                          transparent 25%,
                                          rgba(0, 0, 0, .05) 25%,
                                          rgba(0, 0, 0, .05) 50%,
                                          transparent 50%,
                                          transparent 75%,
                                          rgba(0, 0, 0, .05) 75%,
                                          rgba(0, 0, 0, .05));
        background-size: 20px 20px;
        box-shadow: 0 5px 0 rgba(0, 0, 0, .1);
        left: 0;
        padding: 0.4em 0;
        position: absolute;
        text-align: center;
        top: 0;
        width: 100vw;
      }
    </style>
  </head>
  <body>
    <div class="banner">
      <strong>This polyfill is a work in progress.</strong>
      It does not represent the final API of this proposal, nor even the current consensus.
    </div>
<h1 id="temporal-cookbook">Temporal Cookbook</h1>
<h2 id="running-the-cookbook-files">Running the cookbook files</h2>
<p>Running cookbook files:</p>
<pre><code class="language-sh">node --experimental-modules --no-warnings \
    --icu-data-dir ./polyfill/node_modules/full-icu/ \
    -r ./polyfill/index.js ./docs/cookbook/${cookbookFile}</code></pre>
<p><em>The above code allows <code>Temporal</code> to exist as a global object before the cookbook file runs.</em></p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<p>These are some of the most common tasks that people ask questions about on StackOverflow with legacy Date.
Here&#39;s how they would look using Temporal.</p>
<h3 id="current-date-and-time">Current date and time</h3>
<p>How to get the current date and time in the local time zone?</p>
<pre><code class="language-javascript">/**
 * Get the current date in JavaScript
 * This is a popular question on Stack Overflow for dates in JS
 * https://stackoverflow.com/questions/1531093/how-do-i-get-the-current-date-in-javascript
 *
 */

const dateTime = Temporal.now.dateTime(); // Gets the current date
dateTime.toString(); // returns the date in ISO 8601 date format</code></pre>
<h3 id="unix-timestamp">Unix timestamp</h3>
<p>How to get a Unix timestamp?</p>
<pre><code class="language-javascript">/**
 * Get a (Unix) timestamp in JavaScript
 * This is the No.1 voted question on Stack Overflow for dates in JS
 * https://stackoverflow.com/questions/221294/how-do-you-get-a-timestamp-in-javascript
 *
 */

const timeStamp = Temporal.now.absolute();

// Timestamp in Milliseconds
timeStamp.getEpochMilliseconds();
// Timestamp in Seconds
timeStamp.getEpochSeconds();</code></pre>
<h2 id="converting-between-temporal-types-and-legacy-date">Converting between Temporal types and legacy Date</h2>
<h3 id="absolute-from-legacy-date">Absolute from legacy Date</h3>
<p>Map a legacy ECMAScript Date instance into a Temporal.Absolute instance corresponding to the same instant in absolute time.</p>
<pre><code class="language-javascript">import assert from &#39;assert&#39;;

const legacyDate = new Date(&#39;1970-01-01T00:00:01Z&#39;);

// Convert legacy Date to Temporal.Absolute
const absolute = Temporal.Absolute.fromEpochMilliseconds(legacyDate.getTime());

assert(absolute instanceof Temporal.Absolute);</code></pre>
<h2 id="construction">Construction</h2>
<h3 id="zoned-instant-from-instant-and-time-zone">Zoned instant from instant and time zone</h3>
<p>Map a Temporal.Absolute instance and a time zone name into a string serialization of the local time in that zone corresponding to the instant in absolute time.</p>
<pre><code class="language-javascript">import assert from &#39;assert&#39;;

/**
 * Converts an absolute point in time to a string with the time in the specified
 * time zone and a time zone designation.
 *
 * @param {Temporal.Absolute} absolute An absolute point in time
 * @param {string} ianaTimeZoneName IANA name of a time zone
 * @returns {string} String indicating the time with time zone designation
 */
function getParseableIanaZonedStringAtInstant(absolute, ianaTimeZoneName) {
  const timeZoneObject = Temporal.TimeZone.from(ianaTimeZoneName);
  return getParseableZonedStringAtInstant(absolute, timeZoneObject);
}

/**
 * Converts an absolute point in time to a string with the time in the specified
 * time zone and a time zone designation.
 *
 * @param {Temporal.Absolute} absolute An absolute point in time
 * @param {string} absolute An absolute point in time
 * @returns {string} String indicating the time with time zone designation
 */
function getParseableZonedStringAtInstant(absolute, timeZone) {
  const dateTimeInZone = absolute.inTimeZone(timeZone);
  const offset = timeZone.getOffsetFor(absolute);
  // If the time zone has only an offset and not an IANA name, then the .name
  // property will be identical to the offset. In that case, don&#39;t append it
  // in square brackets.
  const name = timeZone.name === offset ? &#39;&#39; : `[${timeZone.name}]`;
  return `${dateTimeInZone}${offset}${name}`;
}

const absoluteTime = Temporal.Absolute.from(&#39;2020-01-03T10:41:51Z&#39;);
const result = getParseableIanaZonedStringAtInstant(absoluteTime, &#39;Europe/Paris&#39;);
assert.equal(result, &#39;2020-01-03T11:41:51+01:00[Europe/Paris]&#39;);
assert.equal(Temporal.Absolute.compare(absoluteTime, Temporal.Absolute.from(result)), 0);

const offsetTimeZone = Temporal.TimeZone.from(&#39;-07:00&#39;);
const result2 = getParseableZonedStringAtInstant(absoluteTime, offsetTimeZone);
assert.equal(result2, &#39;2020-01-03T03:41:51-07:00&#39;);
assert.equal(Temporal.Absolute.compare(absoluteTime, Temporal.Absolute.from(result2)), 0);</code></pre>
<h2 id="sorting">Sorting</h2>
<p>Each Temporal type has a <code>compare()</code> static method, which can be passed to <code>Array.prototype.sort()</code> as the compare function in order to sort an array of Temporal types.</p>
<h3 id="sort-datetimes">Sort DateTimes</h3>
<p>Sort a list of <code>Temporal.DateTime</code>s, for example in order to get a conference schedule in the correct order.
Sorting other Temporal types would work exactly the same way as this.</p>
<pre><code class="language-javascript">import assert from &#39;assert&#39;;
/**
 * getSortedLocalDateTimes will sort an array of zoneless Temporal.DateTime instances by the
 * corresponding local date and time of day (e.g., for building a conference schedule).
 *
 *
 * @param {Temporal.DateTime[]} dateTimes This is a DateTime instance
 * @param {boolean} direction reverse
 * @returns {Temporal.DateTime[]} the array from dateTimes, sorted
 */
function getSortedLocalDateTimes(dateTimes, reverse = false) {
  let newDateTimes = Array.from(dateTimes).sort(Temporal.DateTime.compare);

  return reverse ? newDateTimes.reverse() : newDateTimes;
}

// Sorting some conferences without timezones for example vue.js Amsterdam 2020
let a = Temporal.DateTime.from({
  year: 2020,
  day: 20,
  month: 2,
  hour: 8,
  minute: 45
}); // Introduction
let b = Temporal.DateTime.from({
  year: 2020,
  day: 21,
  month: 2,
  hour: 13,
  minute: 10
}); // Lunch Break
let c = Temporal.DateTime.from({
  year: 2020,
  day: 20,
  month: 2,
  hour: 15,
  minute: 30
}); // Coffee Break
const results = getSortedLocalDateTimes([a, b, c]);
assert.equal(results[0], a);
assert.equal(results[1], c);
assert.equal(results[2], b);</code></pre>
<h3 id="sort-iso-datetime-strings">Sort ISO date/time strings</h3>
<p>Sort a list of ISO 8601 date/time strings, for example to place log entries in order.</p>
<pre><code class="language-javascript">import assert from &#39;assert&#39;;

/**
 * getSortedInstants will sort an array of strings (each of which is parseable
 * as a Temporal.Absolute and may or may not include an IANA time zone name)
 * by the corresponding absolute time (e.g., for presenting global log events
 * sequentially).
 *
 *
 * @param {string[]} parseableAbsoluteStrings - a group of ISO Strings
 * @param {boolean} reverse ascending or descending order
 * @returns {string[]} the array from parseableAbsoluteStrings, sorted
 */
function getSortedInstants(parseableAbsoluteStrings, reverse = false) {
  const sortedAbsoluteTimes = parseableAbsoluteStrings
    .map((v) =&gt; [v, Temporal.Absolute.from(v)])
    .sort(([, abs1], [, abs2]) =&gt; Temporal.Absolute.compare(abs1, abs2))
    .map(([str]) =&gt; str);

  return reverse ? sortedAbsoluteTimes.reverse() : sortedAbsoluteTimes;
}

const a = &#39;2020-01-23T17:04:36.491865121-08:00&#39;;
const b = &#39;2020-02-10T17:04:36.491865121-08:00&#39;;
const c = &#39;2019-03-30T01:45:00+01:00[Europe/Berlin]&#39;;
const d = &#39;2019-03-16T01:45:00+00:00[Europe/London]&#39;;
const e = &#39;2019-03-25T01:45:00-06:00[America/New_York]&#39;;

const results = getSortedInstants([a, b, c, d, e]);

// results will have correct order
assert.equal(results[0], &#39;2019-03-16T01:45:00+00:00[Europe/London]&#39;);
assert.equal(results[1], &#39;2019-03-25T01:45:00-06:00[America/New_York]&#39;);
assert.equal(results[2], &#39;2019-03-30T01:45:00+01:00[Europe/Berlin]&#39;);
assert.equal(results[3], &#39;2020-01-23T17:04:36.491865121-08:00&#39;);
assert.equal(results[4], &#39;2020-02-10T17:04:36.491865121-08:00&#39;);</code></pre>
    <footer>
      <p>
        This page includes a script which loads an implementation of Temporal in your browser.
        You can open a console in your browser's developer tools and try it out directly!
      </p>
      <p>View this or help contribute on <a href="https://github.com/tc39/proposal-temporal">GitHub</a>.</p>
    </footer>
    <script>
      // Add permalinks to all <h3> elements (function documentation headings)
      const h3s = document.getElementsByTagName('h3');
      for (let h3 of h3s) {
        const anchor = document.createElement('a');
        anchor.className = 'heading-link';

        // Use the **function name** as the link ID, otherwise fall back to the
        // ID generated by markdown
        let id = h3.getAttribute('id');
        const bold = h3.getElementsByTagName('strong');
        if (bold[0]) {
          id = bold[0].textContent.replace(/[^a-zA-Z]/g, '-');
          h3.setAttribute('id', id);
        }

        anchor.setAttribute('href', `#${id}`);
        h3.prepend(anchor);
      };
    </script>
  </body>
</html>
